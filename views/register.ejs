<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
        <%= title %>
    </title>
    <link rel="stylesheet" href="/styles/main.css" />
</head>

<body>
    <header class="topbar">
        <h2>Terp Notes</h2>
        <div class="user-info">
            <a href="/" class="logout-btn">Home</a>
        </div>
    </header>

    <main class="centered">
        <div class="auth-form">
            <h1>Join Terp Notes</h1>
            <form action="/registerSubmit" method="POST">
                <div class="form-group">
                    <label for="first_name">First Name<span class="req">*</span></label>
                    <input type="text" name="first_name" id="first_name" required placeholder="John" />
                </div>
                <div class="form-group">
                    <label for="last_name">Last Name<span class="req">*</span></label>
                    <input type="text" name="last_name" id="last_name" required placeholder="Doe" />
                </div>
                <div class="form-group">
                    <label for="userid">Username<span class="req">*</span></label>
                    <input type="text" name="userid" id="userid" required placeholder="johndoe" />
                    <div class="username-warning">
                        <strong>‚ö†Ô∏è Important:</strong> Your username is <strong>permanent</strong> and cannot be changed
                        later. Choose carefully!
                    </div>
                </div>
                <div class="form-group">
                    <label for="email">Email<span class="req">*</span></label>
                    <input type="email" name="email" id="email" required placeholder="john@umd.edu" />
                </div>
                <div class="form-group">
                    <label for="password">Password<span class="req">*</span></label>
                    <input type="password" name="password" id="password" required
                        placeholder="Enter a secure password" />
                </div>
                <div class="form-group">
                    <label for="confirm_pass">Confirm Password<span class="req">*</span></label>
                    <input type="password" name="confirm_pass" id="confirm_pass" required
                        placeholder="Re-enter your password" />
                </div>
                <div class="form-group terms-agreement">
                    <div class="terms-box">
                        <h4>üìã Legal Agreement</h4>
                        <p class="terms-text">
                            By creating an account, you must read and accept:
                        </p>

                        <label class="checkbox-label" style="margin: 1rem 0; display: flex; align-items: flex-start;">
                            <input type="checkbox" id="agreeTerms" name="agreeTerms" required
                                style="margin-top: 0.25rem; flex-shrink: 0;">
                            <span style="margin-left: 0.5rem;">I have read and accept the
                                <a href="/terms" target="_blank"
                                    style="color: var(--umd-red); font-weight: 600; text-decoration: underline;">Terms
                                    of Service</a>
                            </span>
                        </label>

                        <label class="checkbox-label" style="margin: 1rem 0; display: flex; align-items: flex-start;">
                            <input type="checkbox" id="agreePrivacy" name="agreePrivacy" required
                                style="margin-top: 0.25rem; flex-shrink: 0;">
                            <span style="margin-left: 0.5rem;">I have read and accept the
                                <a href="/privacy" target="_blank"
                                    style="color: var(--umd-red); font-weight: 600; text-decoration: underline;">Privacy
                                    Policy</a>
                            </span>
                        </label>

                        <div
                            style="background: #FEF3C7; padding: 1rem; border-radius: 8px; margin-top: 1rem; font-size: 0.875rem; line-height: 1.6; border: 1px solid #F59E0B;">
                            <strong>‚ö†Ô∏è Quick Summary:</strong>
                            <ul style="margin: 0.5rem 0 0 1.25rem; padding: 0;">
                                <li>Educational purposes only</li>
                                <li>No unauthorized exam/project sharing</li>
                                <li>Respect academic integrity</li>
                                <li>Independent platform (NOT affiliated with UMD)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="form-buttons">
                    <input type="submit" value="Sign Up" class="button primary" id="submitBtn" />
                    <input type="reset" value="Clear" class="button secondary" />
                </div>
            </form>
            <div class="alt-link">
                <p>Already have an account? <a href="/login">Login here</a></p>
            </div>
        </div>
    </main>

    <footer>
        <p>
            &copy; <%= new Date().getFullYear() %> Terp Notes<br>
                <a href="/privacy">Privacy</a> |
                <a href="/terms">Terms</a> |
                <a href="/contact">Contact</a>
        </p>
    </footer>

    <script>
        // Password match validation for registration
        document.addEventListener('DOMContentLoaded', function () {
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirm_pass');
            const termsCheckbox = document.getElementById('agreeTerms');
            const privacyCheckbox = document.getElementById('agreePrivacy');
            const submitBtn = document.getElementById('submitBtn');

            function checkFormValidity() {
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;
                const termsAgreed = termsCheckbox.checked;
                const privacyAgreed = privacyCheckbox.checked;

                // Remove existing error message
                const existingError = confirmPasswordInput.parentElement.querySelector('.password-match-error');
                if (existingError) existingError.remove();

                let passwordsValid = true;

                // Only show error if confirm password field has content
                if (confirmPassword && password !== confirmPassword) {
                    const errorDiv = document.createElement('small');
                    errorDiv.className = 'password-match-error';
                    errorDiv.style.color = '#EF4444';
                    errorDiv.style.display = 'block';
                    errorDiv.style.marginTop = '0.5rem';
                    errorDiv.textContent = '‚ö†Ô∏è Passwords do not match';
                    confirmPasswordInput.parentElement.appendChild(errorDiv);
                    passwordsValid = false;
                } else if (confirmPassword && password === confirmPassword) {
                    const successDiv = document.createElement('small');
                    successDiv.className = 'password-match-error';
                    successDiv.style.color = '#10B981';
                    successDiv.style.display = 'block';
                    successDiv.style.marginTop = '0.5rem';
                    successDiv.textContent = '‚úì Passwords match';
                    confirmPasswordInput.parentElement.appendChild(successDiv);
                }

                // Disable submit if passwords don't match OR terms/privacy not agreed
                if (!passwordsValid || !termsAgreed || !privacyAgreed) {
                    submitBtn.disabled = true;
                    submitBtn.style.opacity = '0.5';
                    submitBtn.style.cursor = 'not-allowed';
                } else {
                    submitBtn.disabled = false;
                    submitBtn.style.opacity = '1';
                    submitBtn.style.cursor = 'pointer';
                }
            }

            passwordInput.addEventListener('input', checkFormValidity);
            confirmPasswordInput.addEventListener('input', checkFormValidity);
            termsCheckbox.addEventListener('change', checkFormValidity);
            privacyCheckbox.addEventListener('change', checkFormValidity);

            // Initial check
            checkFormValidity();
        });
    </script>
</body>

</html>
