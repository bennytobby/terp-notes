<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - Terp Notes</title>
    <link rel="stylesheet" href="/styles/main.css">
</head>

<body>
    <div class="auth-page">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üê¢ Terp Notes</h1>
                <h2>Create New Password</h2>
                <p>Enter your new password below</p>
            </div>

            <form action="/reset-password/<%= token %>" method="POST" class="auth-form">
                <div class="form-group">
                    <label for="password">New Password</label>
                    <input type="password" id="password" name="password" required autofocus minlength="6">
                </div>

                <div class="form-group">
                    <label for="confirm_password">Confirm New Password</label>
                    <input type="password" id="confirm_password" name="confirm_password" required minlength="6">
                </div>

                <button type="submit" class="button primary full-width">Reset Password</button>
            </form>

            <div class="auth-footer">
                <p><a href="/login">Back to Login</a></p>
            </div>
        </div>
    </div>

    <script>
        // Password match validation
        document.addEventListener('DOMContentLoaded', function () {
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirm_password');
            const submitBtn = document.querySelector('button[type="submit"]');

            function checkPasswordMatch() {
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;

                const existingError = confirmPasswordInput.parentElement.querySelector('.password-match-error');
                if (existingError) existingError.remove();

                if (confirmPassword && password !== confirmPassword) {
                    const errorDiv = document.createElement('small');
                    errorDiv.className = 'password-match-error';
                    errorDiv.style.color = '#EF4444';
                    errorDiv.style.display = 'block';
                    errorDiv.style.marginTop = '0.5rem';
                    errorDiv.textContent = '‚ö†Ô∏è Passwords do not match';
                    confirmPasswordInput.parentElement.appendChild(errorDiv);
                    submitBtn.disabled = true;
                    submitBtn.style.opacity = '0.5';
                } else if (confirmPassword && password === confirmPassword) {
                    const successDiv = document.createElement('small');
                    successDiv.className = 'password-match-error';
                    successDiv.style.color = '#10B981';
                    successDiv.style.display = 'block';
                    successDiv.style.marginTop = '0.5rem';
                    successDiv.textContent = '‚úì Passwords match';
                    confirmPasswordInput.parentElement.appendChild(successDiv);
                    submitBtn.disabled = false;
                    submitBtn.style.opacity = '1';
                } else {
                    submitBtn.disabled = false;
                    submitBtn.style.opacity = '1';
                }
            }

            passwordInput.addEventListener('input', checkPasswordMatch);
            confirmPasswordInput.addEventListener('input', checkPasswordMatch);
        });
    </script>
</body>

</html>
